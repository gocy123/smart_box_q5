###############################################################################
#
# IAR ANSI C/C++ Compiler V7.40.7.9843/W32 for ARM        01/Feb/2018  10:27:23
# Copyright 1999-2015 IAR Systems AB.
#
#    Cpu mode     =  thumb
#    Endian       =  little
#    Source file  =  
#        D:\GitHub2\smart_box_q5\SMART_CARD\Project\App\rf\Encoding_v8.c
#    Command line =  
#        D:\GitHub2\smart_box_q5\SMART_CARD\Project\App\rf\Encoding_v8.c -D
#        USE_STDPERIPH_DRIVER -D STM32F10X_MD -D USE_STM3210B_EVAL -lcN
#        D:\GitHub2\smart_box_q5\SMART_CARD\Project\STM32F10x_StdPeriph_Template\EWARM\STM3210B-EVAL\List
#        -o
#        D:\GitHub2\smart_box_q5\SMART_CARD\Project\STM32F10x_StdPeriph_Template\EWARM\STM3210B-EVAL\Obj
#        --no_unroll --no_inline --no_tbaa --no_scheduling --debug
#        --endian=little --cpu=Cortex-M3 -e --fpu=None --dlib_config
#        "C:\Program Files (x86)\IAR Systems\Embedded Workbench
#        7.2\arm\INC\c\DLib_Config_Full.h" -I
#        D:\GitHub2\smart_box_q5\SMART_CARD\Project\STM32F10x_StdPeriph_Template\EWARM\..\
#        -I
#        D:\GitHub2\smart_box_q5\SMART_CARD\Project\STM32F10x_StdPeriph_Template\EWARM\..\..\OS\BSP\
#        -I
#        D:\GitHub2\smart_box_q5\SMART_CARD\Project\STM32F10x_StdPeriph_Template\EWARM\..\..\OS\uC-CPU\ARM-Cortex-M3\IAR\
#        -I
#        D:\GitHub2\smart_box_q5\SMART_CARD\Project\STM32F10x_StdPeriph_Template\EWARM\..\..\OS\uC-CPU\
#        -I
#        D:\GitHub2\smart_box_q5\SMART_CARD\Project\STM32F10x_StdPeriph_Template\EWARM\..\..\OS\uC-LIB\
#        -I
#        D:\GitHub2\smart_box_q5\SMART_CARD\Project\STM32F10x_StdPeriph_Template\EWARM\..\..\OS\uC-LIB\Ports\ARM-Cortex-M3\IAR\
#        -I
#        D:\GitHub2\smart_box_q5\SMART_CARD\Project\STM32F10x_StdPeriph_Template\EWARM\..\..\OS\uCOS-III\Source\
#        -I
#        D:\GitHub2\smart_box_q5\SMART_CARD\Project\STM32F10x_StdPeriph_Template\EWARM\..\..\OS\uCOS-III\Ports\ARM-Cortex-M3\Generic\IAR\
#        -I
#        D:\GitHub2\smart_box_q5\SMART_CARD\Project\STM32F10x_StdPeriph_Template\EWARM\..\..\Libraries\CMSIS\CM3\DeviceSupport\ST\STM32F10x\
#        -I
#        D:\GitHub2\smart_box_q5\SMART_CARD\Project\STM32F10x_StdPeriph_Template\EWARM\..\..\Libraries\CMSIS\CM3\CoreSupport\
#        -I
#        D:\GitHub2\smart_box_q5\SMART_CARD\Project\STM32F10x_StdPeriph_Template\EWARM\..\..\Libraries\STM32F10x_StdPeriph_Driver\inc\
#        -I
#        D:\GitHub2\smart_box_q5\SMART_CARD\Project\STM32F10x_StdPeriph_Template\EWARM\..\..\Utility\
#        -I
#        D:\GitHub2\smart_box_q5\SMART_CARD\Project\STM32F10x_StdPeriph_Template\EWARM\..\..\network_layer\nwl_uart1\
#        -I
#        D:\GitHub2\smart_box_q5\SMART_CARD\Project\STM32F10x_StdPeriph_Template\EWARM\..\
#        -I
#        D:\GitHub2\smart_box_q5\SMART_CARD\Project\STM32F10x_StdPeriph_Template\EWARM\..\..\network_layer\nwl_uart2\
#        -I
#        D:\GitHub2\smart_box_q5\SMART_CARD\Project\STM32F10x_StdPeriph_Template\EWARM\..\..\App\user_debug\
#        -I
#        D:\GitHub2\smart_box_q5\SMART_CARD\Project\STM32F10x_StdPeriph_Template\EWARM\..\..\App\dev_manage\
#        -I
#        D:\GitHub2\smart_box_q5\SMART_CARD\Project\STM32F10x_StdPeriph_Template\EWARM\..\..\App\modem\sim800\
#        -I
#        D:\GitHub2\smart_box_q5\SMART_CARD\Project\STM32F10x_StdPeriph_Template\EWARM\..\..\App\protocol_communication\protocol_jt808\
#        -I
#        D:\GitHub2\smart_box_q5\SMART_CARD\Project\STM32F10x_StdPeriph_Template\EWARM\..\..\App\rtc\
#        -I
#        D:\GitHub2\smart_box_q5\SMART_CARD\Project\STM32F10x_StdPeriph_Template\EWARM\..\..\App\gps\
#        -I
#        D:\GitHub2\smart_box_q5\SMART_CARD\Project\STM32F10x_StdPeriph_Template\EWARM\..\..\network_layer\nwl_uart3\
#        -I
#        D:\GitHub2\smart_box_q5\SMART_CARD\Project\STM32F10x_StdPeriph_Template\EWARM\..\..\App\modem\quecelMC20\
#        -I
#        D:\GitHub2\smart_box_q5\SMART_CARD\Project\STM32F10x_StdPeriph_Template\EWARM\..\..\App\rf\
#        -I
#        D:\GitHub2\smart_box_q5\SMART_CARD\Project\STM32F10x_StdPeriph_Template\EWARM\..\..\App\internal_flash\
#        -Om --use_c++_inline -I "C:\Program Files (x86)\IAR Systems\Embedded
#        Workbench 7.2\arm\CMSIS\Include\"
#    List file    =  
#        D:\GitHub2\smart_box_q5\SMART_CARD\Project\STM32F10x_StdPeriph_Template\EWARM\STM3210B-EVAL\List\Encoding_v8.lst
#    Object file  =  
#        D:\GitHub2\smart_box_q5\SMART_CARD\Project\STM32F10x_StdPeriph_Template\EWARM\STM3210B-EVAL\Obj\Encoding_v8.o
#
###############################################################################

D:\GitHub2\smart_box_q5\SMART_CARD\Project\App\rf\Encoding_v8.c
      1          #include "Encoding_v8.h"
      2          
      3          #define small_data 0x9e3779b9	//iv8 ok
      4          #define large_data 0xc6ef3720
      5          
      6          uchar const Data_58F0[] = {0x0B,0x46,0x50,0x2D,0x5E,0x25,0x37,0x18,0x2B,0xF9,0x3A,0x19,0x62,0x2C,0x12,0x06};
      7          
      8          ulong Char2Long(uchar const *pt) {
      9          	un_DWORD tmp;
     10          	tmp.byte[0] = pt[3];
     11          	tmp.byte[1] = pt[2];
     12          	tmp.byte[2] = pt[1];
     13          	tmp.byte[3] = pt[0];
     14          	return tmp.words;
     15          	
     16          }
     17          void Long2Char(ulong t1, uchar *sp) {
     18          	uchar *p = (uchar *)(&t1);
     19          	sp[3] = *p;
     20          	sp[2] = *(p + 1);
     21          	sp[1] = *(p + 2);
     22          	sp[0] = *(p + 3);
     23          }
     24          void DBCM_46E9(ulong t1, uchar *pt) {
     25          	ulong t2 = Char2Long(pt);
     26          	t2 -= t1;
     27          	Long2Char(t2, pt);
     28          }
     29          void IV8_Decrypt(uchar* iData) 
     30          {
     31          	uchar sp[20];
     32          	uchar i;
     33          	ulong t1 = large_data;
     34          
     35          	Long2Char(t1, sp + 8);     //Ìîsp[8~~11]
     36          
     37          	for(i = 0; i < 8; i++) 
     38          	{
     39          		sp[i + 12] = iData[i]; //Ìîsp[12~~19]
     40          	}
     41          	
     42          loop:
     43          	t1 = (sp[9] << 8) + sp[10];
     44          	t1 = (t1 >> 3);
     45          	t1 = (t1 & 0x3);
     46          	t1 = (t1 << 2);
     47          	t1 = Char2Long(Data_58F0 + t1) + Char2Long(sp + 8);
     48          	Long2Char(t1, sp + 4);
     49          	
     50          	t1 = Char2Long(sp + 12);
     51          	t1 = (t1 + ((t1 >> 5) ^ (t1 << 4))) ^ Char2Long(sp + 4);
     52          	DBCM_46E9(t1, sp + 16);
     53          	
     54          	t1 = Char2Long(sp + 8);
     55          	t1 = (t1 - small_data);
     56          	Long2Char(t1, sp + 8);
     57          	
     58          	t1 = ((sp[11] & 0x3) << 2);
     59          	t1 = Char2Long(Data_58F0 + t1) + Char2Long(sp + 8);
     60          	Long2Char(t1, sp + 4);
     61          
     62          	t1 = Char2Long(sp + 16);
     63          	t1 = (t1 + ((t1 >> 5) ^ (t1 <<4 ))) ^ Char2Long(sp + 4);
     64          	DBCM_46E9(t1, sp + 12);
     65          
     66          	t1 = Char2Long(sp + 8);
     67          	if(t1 != 0) goto loop;
     68          	
     69          	for(i = 0; i < 8; i++) iData[i] = sp[i + 12];
     70          }

   Maximum stack usage in bytes:

   .cstack Function
   ------- --------
       4   Char2Long
      16   DBCM_46E9
        16   -> Char2Long
         0   -> Long2Char
      40   IV8_Decrypt
        40   -> Char2Long
        40   -> DBCM_46E9
        40   -> Long2Char
       4   Long2Char


   Section sizes:

   Bytes  Function/Label
   -----  --------------
       4  ??DataTable1
       4  ??DataTable1_1
      32  Char2Long
      22  DBCM_46E9
      16  Data_58F0
     204  IV8_Decrypt
      30  Long2Char

 
 312 bytes in section .text
 
 312 bytes of CODE memory

Errors: none
Warnings: none
